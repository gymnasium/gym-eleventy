---js
{
  layout: "layouts/main.njk",
  pagination: {
    data: "courses",
    size: 1,
    alias: "item",
    resolve: "values",
    before: function(data) {
      const items = data.filter(x => x.tags.includes('course'));
      // console.log(items);
      return items;
    },
    addAllPagesToCollections: true,
  },
  permalink: "courses/{{ item.title | slugify }}/",
  eleventyComputed: {
    meta: {
      title: "{{ item.title }} | Courses",
      description: "{{ item.description | strip_html }}",
      sitemapDate: "{{ item.date.toISOString() }}",
      sitemapExclude: function(data) {
        const bool = data.item.sitemapExclude ? data.item.sitemapExclude : false;
        return bool;
      },
    },
  },
}
---
<main>
  <header id="{{ item.id }}" class="page-header {{ item.id }}">
    <h1>{{ item.title }}</h1>
    <h4>{{ item.id }}</h4>
    <img src="{{config.cms_url}}{{item.img}}" alt="Course image for {{item.title}}">
  </header>

  {# TODO: sort out the retired message business #}
  {%- if (not item.live) and (item.retired_message) -%}
    <p>{{ item.description | safe }}</p>

    {%- if item.retired_message[1] -%}
      <p>{{ item.retired_message[1] | safe }}</p>
    {%- endif -%}

    {%- if item.retired_message[2] -%}
      <p>{{ item.retired_message[2] | safe }}</p>
    {%- endif -%}
  {%- else -%}
    <p>{{ item.description | safe }}</p>
  {%- endif -%}

  {# Attempt to replicate the existing course about page content #}
  {%- if item.intro -%}
    <p>{{ item.intro | safe }}</p>
  {%- endif -%}

  {%- if item.preview -%}
    <h2>{{ item.preview.heading }}</h2>

    {%- if item.preview.video_id -%}
      {%- youtube item.preview.video_id -%}
    {%- endif -%}
  {%- endif -%}

  {%- if item.about -%}
    <h2>{{ item.about.heading }}</h2>
    
    {%- if item.about.description -%}
      <p>{{ item.about.description }}</p>
    {%- endif -%}
  {%- endif -%}

  {%- if item.outline -%}
    <h2>{{ item.outline.heading }}</h2>
    
    {%- if item.outline.description -%}
      <p>{{ item.outline.description }}</p>
    {%- endif -%}

    {%- if item.outline.list -%}
      <ul>
        {%- for idx in range(0, item.outline.list.length) -%}
          <li>
            <h3>{{ item.outline.list[idx].heading }}</h3>
            <p>{{ item.outline.list[idx].description }}</p>
          </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}
  {%- endif -%}

  {%- if item.audience -%}
    <h2>Audience</h2>
    <ul>
      {%- for idx in range(0, item.audience.length) -%}
        <li>{{ item.audience[idx].label }}</li>
      {%- endfor -%}
    </ul>
  {%- endif -%}

  {%- if item.skills -%}
    <h2>Skills</h2>
    <ul>
      {%- for idx in range(0, item.skills.length) -%}
        <li>{{ item.skills[idx].label }}</li>
      {%- endfor -%}
    </ul>
  {%- endif -%}


  {%- if item.prerequisites -%}
    <h2>Prerequisites</h2>
    <ul>
      {%- for idx in range(0, item.prerequisites.length) -%}
        <li>{{ item.prerequisites[idx].label | safe }}</li>
      {%- endfor -%}
    </ul>
  {%- endif -%}

  {%- if item.requirements -%}
    <h2>Requirements</h2>
    <ul>
      {%- for idx in range(0, item.requirements.list.length) -%}
        <li>{{ item.requirements.list[idx].label | safe }}</li>
      {%- endfor -%}
    </ul>
  {%- endif -%}
</main>

<aside>
  <h2>Meet the Instructor</h2>
  <img src="{{ config.cms_url }}/img/webinar-bio-headshots/{{ bios[item.instructor].img }}" alt="">
  <h3>{{ bios[item.instructor].name }}</h3>
  <p>{{ bios[item.instructor].description | safe }}</p>
  

  {%- if bios[item.instructor].extended_description -%}
    {{ bios[item.instructor].extended_description | safe }}
  {%- endif -%}
</aside>




