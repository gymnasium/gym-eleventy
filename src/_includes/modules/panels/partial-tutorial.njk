{%- set obj = collections.catalog[filteredId] -%}
{%- set img = obj.img -%}
{%- set title = obj.title | strip_html -%}

{%- if obj.subtitle -%}
  {%- set subtitle = obj.subtitle | strip_html -%}
{%- elif module.subtitle -%}

  {%- if module.subtitle | is_string -%}
    {%- set subtitle = module.subtitle -%}
  {%- elif module.subtitle | is_object -%}
    {% set key = module.subtitle.key %}
    {% set collect = collections[module.subtitle.data] %}
    {{collect.key}}

    {%- set subtitle -%}{%- if module.subtitle['pre'] -%}{{ module.subtitle['pre'] }} {% endif -%}{{ bios[obj.instructor]['name'] }}{%- if module.subtitle['post'] -%} {{ module.subtitle['post'] }}{% endif -%}{%- endset -%}
  {%- endif -%}
{%- endif -%}

{%- set topic = obj.topic -%}
{%- set topic_featured = obj.topic_featured-%}
{%- set subtopics = obj.subtopics -%}
{%- set description = obj.description -%}

{%- if obj.slug -%}
  {%- set slug = obj.slug -%}
{%- else -%}
  {%- set slug = title | slugify -%}
{%- endif -%}

{%- set shortId = obj.id -%}
{%- set type = obj.type -%}

{%- set src = config.urls.root + img -%}
{%- set srcSet = src -%}

{%- set url = '/courses/take5/' + obj.title | slugify -%}

<li class="course {{ type }} {{ shortId | lower }} {{ topic | slugify }}{% if subtopics %}{% for subtopic in subtopics %} {{ subtopic.label | slugify }}{% endfor %}{% endif %}{% if topic_featured %} featured{% endif %}">
  <article id="{{ shortId | lower }}" class="course-card">
    <div class="main">
      <a href="{{ url }}">
        <div class="artwork">
          <img alt="Course artwork for {{ title }}." src="{{ src }}" srcset="{{ srcSet }}" decoding="async" fetchpriority="high" width="1280" height="720">
        </div>
      </a>
      <header>
        <hgroup>
          <p class="topic"><b>{{ topic }}</b></p>
          <h2 class="title"><a href="{{ url }}">{{ title }}</a></h2>
          <p class="instructor" hidden>with {{ bios[obj.instructor]['name'] }}, {{  bios[obj.instructor]['subtitle'] }}</p>
        </hgroup>
        <p class="description">{{ description }}</p>
      </header>
      <div class="cta">
        <a class="btn" href="{{ url }}">Explore Course</a>
      </div>
      <footer class="info">
        <h3>{{ obj.type | replace('full', 'Full Course') | replace('short', 'Gym Short') }}</h3>
        <p>{{ obj.skill_level }}</p>
      </footer>
    </div>
    <footer class="back-to">
      <p><a href="#topics">Back to Menu</a></p>
    </footer>
  </article>
</li>
